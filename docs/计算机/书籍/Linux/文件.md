# Linux

### 1. 计算机系统运行

① 通过输入设备或网络适配器，向计算机发起请求。

② 读取内存中的命令，并在CPU上执行，把结果写入负责保存数据的内存区域中。

③ 将内存中的数据写入HDD（Hard Disk Drive，硬盘驱动器）、SDD（Solid State Disk，固态硬盘）等存储器，或者通过网络发送给其他计算机，或者通过输出设备提供给用户。

④回到步骤①。

#### 1.1 程序的分类

- 应用程序：能让用户直接使用，为用户提供帮助的程序，例如计算机上的办公软件、智能手机和平板电脑上的应用

- 中间件：将对大部分应用程序通用的功能分离出来，以辅助应用程序运行的程序，例如Web服务器、数据库系统
- OS：直接控制硬件设备，同时为应用程序与中间件提供运行环境的程序，例如Linux

### 2. 用户模式

#### 2.1 系统调用

●进程控制（创建和删除）

●内存管理（分配和释放）

●进程间通信

●网络管理

●文件系统操作

●文件操作（访问设备）

### 3. 进程管理

#### 3.1 创建进程

- 将同一个程序分成多个进程处理
- 创建另一个程序

#### 3.2 fork 函数

- 基于发起调用的进程，创建一个新的进程

#### 3.3 结束进程

- _exit() 函数
- C 标准库exit()函数

### 4. 进程调度器

#### 4.1 调度器

- 一个 CPU 同时只运行一个进程

- 在同时运行多个进程时，每个进程都会获得适当的时长，轮流在 CPU 上执行处理

#### 4.2 上下文切换

- 存在两个进程时，在消耗完一个时间片后进行上下文切换

#### 4.3 进程状态

|  状态名  |                         含义                          |
| :------: | :---------------------------------------------------: |
|  运行态  |                   正在逻辑CPU上运行                   |
|  就绪态  |           进程具备运行条件，等待分配CPU时间           |
|  睡眠态  | 进程不准备运行，除非发生某事件。在此期间不消耗CPU时间 |
| 僵死状态 |         进程运行结束，正在等待父进程将其回收          |

#### 4.4 吞吐量与延迟

- 吞吐量：单位时间内的总工作量，越大越好
- 延迟：各种处理从开始到完成所耗费的时间，越短越好
- 吞吐量=处理完成的进程数量/耗费的时间
- 延迟=结束处理的时间 — 开始处理的时间

#### 4.5 运行进程

- 对于多核CPU的计算机来说，只有同时运行多个进程才能提高吞吐量，“有n个核心就有n倍性能”这种说法，说到底也只存在于理想状态中
- 与只有单个逻辑CPU时一样，当进程数量多于逻辑CPU数量时，吞吐量就不会再提高

#### 4.6 运行时间和执行时间

- 运行时间 : 进程从开始运行到运行结束为止所经过的时间。类似于利用秒表从开始运行的时间点开始计时,一直测量到运行结束

- 执行时间:进程实际占用逻辑CPU的时长

### 5. 内存管理

#### 5.1 free 命令

- 获取内存信息

#### 5.2 相关字段

- total 字段:系统搭载的物理内存总量。
- free 字段:表面上的可用内存量 ( 详情请参考下面的 available 字段的说明 )
- buff/cache 宇段：缓冲区缓存与页面缓存 ( 详见第6章 ) 占用的内存。当系统的可用内存量 ( free 字段的值）减少时，可通过内核将它们释放出来
- available 字段：实际的可用内存量。本字段的值为 free 字段的值加上当内存不足时内核中可释放的内存量。

​       "可释放的内存"指缓冲区缓存与页面缓存中的大部分内存，以及内核中除此以外的用于其他地方的部分内存

#### 5.3 内存分配时机

- 在创建进程时
- 在创建完进程后，动态分配内存时

#### 5.4 存在问题

- 内存碎片化
- 访问用于其他用途的内存区域
- 难以执行多任务

#### 5.5 <font color=Darkorange>虚拟内存</font>

- 简而言之，`虚拟内存` 使进程无法直接访问系统上搭载的内存，取而代
  之的是通过 `虚拟地址` 间接访问。进程可以看见的是 `虚拟地址`，系统上搭载
  的内存的实际地址称为 <font color=DarkOrchid>物理地址</font>。此外，可以通过地址访问的范围称为 <font color=DarkTurquoise>地址空间</font>
